---
title: "æ¢è®¨ç³»ç»Ÿä¸­ğŸ’°é’±çš„ç²¾åº¦é—®é¢˜"
date: 2021-12-20T12:20:38+08:00
draft: true
toc: true
images:
tags:
  - Go
---

> `é’±,ä¹ƒäº˜å¤ä¹‹ç„ç‰©,æœ‰åˆ™æ°”ç²—ç¥å£®,ç¼ºåˆ™å¿ƒå‘åŠ›æµ…`

åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œç‰¹åˆ«æ˜¯ä¸€ä¸ªå’Œé’±ç›¸å…³çš„ç³»ç»Ÿï¼Œé’±ä¹ƒé‡ä¸­ä¹‹é‡ï¼Œè®¡ç®—æ—¶çš„ç²¾åº¦å°†æ˜¯æœ¬ç¯‡è®¨è®ºçš„ä¸»é¢˜ã€‚

## ç²¾åº¦ä¸ºä½•å¦‚æ­¤é‡è¦

â€œç§¯ç¾½æ²‰èˆŸâ€ç”¨åœ¨æ­¤å¤„æœ€ä¸ºåˆé€‚ã€‚å‡å¦‚æŸç”µå•†å¹³å°æ¯å¹´è®¢å•æˆäº¤æ•°é‡ä¸º10äº¿ï¼Œæ¯ç¬”è®¢å•å°‘ç»“ç®—1åˆ†é’±ï¼Œåˆ™ç´¯è®¡æŸå¤±`1000ä¸‡`ï¼æœ‰ä¸€è¯´ä¸€ï¼Œè¿™æŸå¤±çš„é’±å°±æ˜¯ç‹æŸäººçš„ååˆ†ä¹‹ä¸€ä¸ªå°ç›®æ ‡ã€‚å¦‚æœå› ä¸ºç²¾åº¦é—®é¢˜åœ¨ç»™å®¢æˆ·ç»“ç®—æ—¶ï¼Œå°‘ç®—ä¼šæŸå¤±å®¢æˆ·ï¼Œå¤šç®—ä¼šæŸå¤±é’±ã€‚ç”±æ­¤å¯è§ï¼Œç²¾ç¡®çš„è®¡ç®—é’±ååˆ†é‡è¦ï¼

## ä¸ºä»€ä¹ˆä¼šæœ‰ç²¾åº¦çš„é—®é¢˜

ç»å…¸æ¡ˆä¾‹ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹`0.1 + 0.2`åœ¨è®¡ç®—æœºä¸­æ˜¯å¦ç­‰äº`0.3`ã€‚

![](https://note.youdao.com/yws/api/personal/file/WEBf804d312461f4ec67ccd01132997ffff?method=download&shareKey=d0bf734abc1fe9de099227c381b3bb17)


ä¸Šè¿°caseå­¦è¿‡è®¡ç®—æœºçš„åº”è¯¥éƒ½çŸ¥é“ï¼Œè®¡ç®—æœºæ˜¯äºŒè¿›åˆ¶çš„ï¼Œç”¨äºŒè¿›åˆ¶è¡¨ç¤ºæµ®ç‚¹æ•°æ—¶(IEEE754æ ‡å‡†)ï¼Œåªæœ‰å°‘é‡çš„æ•°å¯ä»¥ç”¨è¿™ç§æ–¹æ³•ç²¾ç¡®çš„è¡¨ç¤ºå‡ºæ¥ã€‚ä¸‹é¢ä»¥0.3ä¸ºä¾‹çœ‹ä¸€ä¸‹åè¿›åˆ¶è½¬äºŒè¿›åˆ¶å°æ•°çš„è¿‡ç¨‹ã€‚

![](https://note.youdao.com/yws/api/personal/file/WEB5b5f3c3225eb1ed793afcf58b832bb90?method=download&shareKey=8a5ae11fcdb830ec79006aea6b09a560)

è®¡ç®—æœºçš„ä½æ•°æœ‰é™åˆ¶ï¼Œå› æ­¤è®¡ç®—æœºç”¨æµ®ç‚¹æ•°è®¡ç®—æ—¶è‚¯å®šæ— æ³•å¾—åˆ°ç²¾ç¡®çš„ç»“æœã€‚è¿™ç§ç¡¬é™åˆ¶æ— æ³•çªç ´ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥ç²¾åº¦ä»¥ä¿è¯å¯¹é’±çš„è®¡ç®—åœ¨å…è®¸çš„è¯¯å·®èŒƒå›´å†…å°½å¯èƒ½å‡†ç¡®ã€‚


> å…³äºæµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­çš„å®é™…è¡¨ç¤ºæœ¬æ–‡ä¸åšè¿›ä¸€æ­¥è®¨è®ºï¼Œå¯ä»¥å‚è€ƒä¸‹è¿°è¿æ¥å­¦ä¹ ï¼š
>
> å•ç²¾åº¦æµ®ç‚¹æ•°è¡¨ç¤ºï¼š
>
> https://en.wikipedia.org/wiki/Single-precision_floating-point_format
>
> åŒç²¾åº¦æµ®ç‚¹æ•°è¡¨ç¤ºï¼š
>
> https://en.wikipedia.org/wiki/Double-precision_floating-point_format
>
> æµ®ç‚¹æ•°è½¬æ¢å™¨ï¼š
>
> https://www.h-schmidt.net/FloatConverter/IEEE754.html

## ç”¨æµ®ç‚¹æ•°è®¡ç®—

è¿˜æ˜¯ä»¥ä¸Šè¿°`0.1 + 0.2`ä¸ºä¾‹ï¼Œ`0.00000000000000004`çš„è¯¯å·®å®Œå…¨å¯ä»¥å¿½ç•¥ï¼Œæˆ‘ä»¬å°è¯•å°æ•°éƒ¨åˆ†ä¿ç•™5ä½ç²¾åº¦ï¼Œçœ‹ä¸‹é¢ç»“æœã€‚

![](https://note.youdao.com/yws/api/personal/file/WEBa904cba0f98c32314621cf074596c667?method=download&shareKey=4a3cfa75c5e38ec58ec3ebc408d6c583)

æ­¤æ—¶çš„ç»“æœç¬¦åˆé¢„æœŸã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæ—¶å€™åˆ¤æ–­ä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¦ç›¸ç­‰å¾€å¾€é‡‡ç”¨`a - b <= 0.00001`çš„å½¢å¼ï¼Œè¯´ç™½äº†è¿™å°±æ˜¯å°æ•°éƒ¨åˆ†ä¿ç•™5ä½ç²¾åº¦çš„å¦ä¸€ç§è¡¨ç°å½¢å¼ã€‚

## ç”¨æ•´å‹è®¡ç®—

å‰é¢æåˆ°åªæœ‰å°‘é‡çš„æµ®ç‚¹æ•°å¯ä»¥ç”¨IEEE754æ ‡å‡†è¡¨ç¤ºï¼Œè€Œæ•´å‹å¯ç²¾ç¡®è¡¨ç¤ºæ‰€æœ‰æœ‰æ•ˆèŒƒå›´å†…çš„æ•°ã€‚å› æ­¤å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œä½¿ç”¨æ•´å‹è¡¨ç¤ºæµ®ç‚¹æ•°ã€‚

ä¾‹å¦‚ï¼Œäº‹å…ˆå®šå¥½å°æ•°ä¿ç•™8ä½ç²¾åº¦ï¼Œåˆ™`0.1`å’Œ`0.2`åˆ†åˆ«è¡¨ç¤ºæˆæ•´æ•°ä¸º`10000000`å’Œ`20000000`,  æµ®ç‚¹æ•°çš„è¿ç®—ä¹Ÿå°±è½¬æ¢ä¸ºæ•´å‹çš„è¿ç®—ã€‚è¿˜æ˜¯ä»¥`0.1 + 0.2`ä¸ºä¾‹ã€‚

```go
// è¡¨ç¤ºå°æ•°ä½ä¿ç•™8ä½ç²¾åº¦
const prec = 100000000

func float2Int(f float64) int64 {
	return int64(f * prec)
}

func int2float(i int64) float64 {
	return float64(i) / prec
}
func main() {
	var a, b float64 = 0.1, 0.2
	f := float2Int(a) + float2Int(b)
	fmt.Println(a+b, f, int2float(f))
	return
}
```

ä¸Šè¿°ä»£ç è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

![](https://note.youdao.com/yws/api/personal/file/WEB90f4a3faef6fab8ce5230655a4e4b695?method=download&shareKey=7516cb7b6cbd33c1953bcff518cb93d8)

ä¸Šè¿°è¾“å‡ºç»“æœå®Œå…¨ç¬¦åˆé¢„æœŸï¼Œæ‰€ä»¥ç”¨æ•´å‹æ¥è¡¨ç¤ºæµ®ç‚¹æ•°çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå¯è¡Œçš„æ–¹æ¡ˆã€‚ä½†ï¼Œæˆ‘ä»¬ä¸èƒ½å±€é™äºä¸ªä¾‹ï¼Œè¿˜éœ€è¦æ›´å¤šçš„æµ‹è¯•ã€‚

```go
fmt.Println(float2Int(2.3))
```
ä¸Šè¿°ä»£ç è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

![](https://note.youdao.com/yws/api/personal/file/WEBefdbec902ab6904b50790c6dd7c930f4?method=download&shareKey=453064325c56910cf93cb28c166de7cd)

è¿™ä¸ªç»“æœæ˜¯å¦‚æ­¤çš„å‡ºä¹æ„æ–™ï¼Œå´åˆæ˜¯æƒ…ç†ä¹‹ä¸­ã€‚

![](https://note.youdao.com/yws/api/personal/file/WEBe786aa264db530711fa0ab6330c2d52e?method=download&shareKey=80360e18093eac4da4fa7da3629e7aaf)

ä¸Šå›¾è¡¨ç¤º`2.3`åœ¨è®¡ç®—æœºä¸­å®é™…çš„å­˜å‚¨å€¼ï¼Œå› æ­¤ä½¿ç”¨`float2Int`å‡½æ•°è¿›è¡Œè½¬æ¢æ—¶çš„ç»“æœæ˜¯`229999999`è€Œä¸æ˜¯`230000000`ã€‚

è¿™ä¸ªç»“æœå¾ˆæ˜æ˜¾ä¸ç¬¦åˆé¢„æœŸï¼Œåœ¨ç¡®å®šçš„ç²¾åº¦èŒƒå›´å†…ä»æœ‰ç²¾åº¦æŸå¤±ï¼Œå¦‚æœæŠŠè¿™ä¸ªä»£ç å‘åˆ°çº¿ä¸Šï¼Œå¾ˆå¤§æ¦‚ç‡ç¬¬äºŒå¤©å°±ä¼šå…‰é€Ÿç¦»èŒã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€å¼•å…¥`github.com/shopspring/decimal`å³å¯ï¼Œçœ‹ä¸‹é¢ä¿®æ­£åçš„ä»£ç ã€‚

```go
// è¡¨ç¤ºå°æ•°ä½ä¿ç•™8ä½ç²¾åº¦
const prec = 100000000

var decimalPrec = decimal.NewFromFloat(prec)

func float2Int(f float64) int64 {
	return decimal.NewFromFloat(f).Mul(decimalPrec).IntPart()
}

func main() {
	fmt.Println(float2Int(2.3)) // è¾“å‡ºï¼š230000000
}
```
æ­¤æ—¶ç»“æœç¬¦åˆé¢„æœŸï¼Œç³»ç»Ÿå†…éƒ¨çš„æµ®ç‚¹è¿ç®—(åŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•)å‡å¯è½¬æ¢ä¸ºæ•´å‹è¿ç®—ï¼Œè€Œè¿ç®—ç»“æœåªéœ€è¦ä¸€æ¬¡æµ®ç‚¹è½¬æ¢å³å¯ã€‚

åˆ°è¿™é‡Œï¼Œç”¨æ•´å‹è®¡ç®—åŸºæœ¬èƒ½æ»¡è¶³å¤§éƒ¨åˆ†åœºæ™¯ï¼Œä½†ä»æœ‰ä¸¤ä¸ªé—®é¢˜å°šéœ€æ³¨æ„ã€‚

1ã€æ•´å‹è¡¨ç¤ºæµ®ç‚¹æ•°çš„èŒƒå›´æ˜¯å¦æ»¡è¶³ç³»ç»Ÿéœ€æ±‚ã€‚

2ã€æ•´å‹è¡¨ç¤ºæµ®ç‚¹æ•°æ—¶é™¤æ³•ä¾æ—§éœ€è¦è½¬æ¢ä¸ºæµ®ç‚¹æ•°è¿ç®—ã€‚

**æ•´å‹è¡¨ç¤ºæµ®ç‚¹æ•°çš„èŒƒå›´**

ä»¥`int64`ä¸ºä¾‹ï¼Œæ•°å€¼èŒƒå›´ä¸º`-9223372036854775808ï½9223372036854775807`ï¼Œå¦‚æœæˆ‘ä»¬å¯¹å°æ•°éƒ¨åˆ†ç²¾åº¦ä¿ç•™8ä½ï¼Œåˆ™å‰©ä½™è¡¨ç¤ºæ•´æ•°éƒ¨åˆ†ä¾æ—§æœ‰11ä½ï¼Œå³åªè¡¨ç¤ºé’±çš„è¯ä»æ—§å¯ä»¥å­˜å‚¨ä¸Š`ç™¾äº¿`çš„é‡‘é¢ï¼Œè¿™ä¸ªæ•°å€¼å¯¹å¾ˆå¤šç³»ç»Ÿå’Œä¸­å°å‹å…¬å¸è€Œè¨€å·²ç»ç»°ç»°æœ‰ä½™ï¼Œä½†æ˜¯ä½¿ç”¨æ­¤æ–¹å¼å­˜å‚¨é‡‘é¢æ—¶èŒƒå›´ä¾æ—§æ˜¯éœ€è¦æ…é‡è€ƒè™‘çš„é—®é¢˜ã€‚

**æ•´å‹è¡¨ç¤ºæµ®ç‚¹æ•°çš„é™¤æ³•**

åœ¨Goä¸­æ²¡æœ‰éšå¼çš„æ•´å‹è½¬æµ®ç‚¹çš„è¯´æ³•ï¼Œå³æ•´å‹å’Œæ•´å‹ç›¸é™¤å¾—åˆ°çš„ç»“æœä¾æ—§æ˜¯æ•´å‹ã€‚æˆ‘ä»¬ä»¥æ•´å‹è¡¨ç¤ºæµ®ç‚¹æ•°æ—¶ï¼Œå°±å°¤å…¶éœ€è¦æ³¨æ„æ•´å‹çš„é™¤æ³•è¿ç®—ä¼šä¸¢å¤±æ‰€æœ‰çš„å°æ•°éƒ¨åˆ†ï¼Œæ‰€ä»¥ä¸€å®šè¦å…ˆè½¬æ¢ä¸ºæµ®ç‚¹æ•°å†è¿›è¡Œç›¸é™¤ã€‚


## æµ®ç‚¹å’Œæ•´å‹çš„æœ€å¤§ç²¾åº¦

 `int64`çš„èŒƒå›´ä¸º`-9223372036854775808ï½9223372036854775807`ï¼Œåˆ™ç”¨æ•´å‹è¡¨ç¤ºæµ®ç‚¹å‹æ—¶ï¼Œæ•´æ•°éƒ¨åˆ†å’Œå°æ•°éƒ¨åˆ†çš„æœ‰æ•ˆåè¿›åˆ¶ä½æœ€å¤šä¸º`19`ä½ã€‚

`uint64`çš„èŒƒå›´ä¸º`0~18446744073709551615`ï¼Œåˆ™ç”¨æ•´å‹è¡¨ç¤ºæµ®ç‚¹å‹æ—¶ï¼Œæ•´æ•°éƒ¨åˆ†å’Œå°æ•°éƒ¨åˆ†çš„æœ‰æ•ˆåè¿›åˆ¶ä½æœ€å¤šä¸º`20`ä½ï¼Œå› ä¸ºç³»ç»Ÿä¸­è¡¨ç¤ºé‡‘é¢æ—¶ä¸€èˆ¬ä¸ä¼šå­˜å‚¨è´Ÿæ•°ï¼Œæ‰€ä»¥å’Œ`int64`ç›¸æ¯”ï¼Œæ›´åŠ æ¨èä½¿ç”¨`uint64`ã€‚

`float64`æ ¹æ®IEEE754æ ‡å‡†ï¼Œå¹¶å‚è€ƒç»´åŸºç™¾ç§‘çŸ¥å…¶æ•´æ•°éƒ¨åˆ†å’Œå°æ•°éƒ¨åˆ†çš„æœ‰æ•ˆåè¿›åˆ¶ä½ä¸º`15-17`ä½ã€‚

![](https://note.youdao.com/yws/api/personal/file/WEBb978e1253b122cb3d36f2db17ede350d?method=download&shareKey=c34eac96cb76f0e7f4b1acc3da4aabac)

æˆ‘ä»¬çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚

```go
var (
	a float64 = 123456789012345.678
	b float64 = 1.23456789012345678
)

fmt.Println(a, b, decimal.NewFromFloat(a), a == 123456789012345.67)
return
```

ä¸Šè¿°ä»£ç è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

![](https://note.youdao.com/yws/api/personal/file/WEB1c85da3c9f69f02b709dc1f3b3efda68?method=download&shareKey=e4d4c9207af46a31a3dfab77119ce4ae)

æ ¹æ®è¾“å‡ºç»“æœçŸ¥ï¼Œ`float64`æ— æ³•è¡¨ç¤ºæœ‰æ•ˆä½æ•°è¶…è¿‡17ä½çš„åè¿›åˆ¶æ•°ã€‚ä»æœ‰æ•ˆåè¿›åˆ¶ä½æ¥è®²ï¼Œè€è®¸æ›´åŠ æ¨èä½¿ç”¨æ•´å‹è¡¨ç¤ºæµ®ç‚¹æ•°ã€‚


## è®¡ç®—ä¸­å°½é‡ä¿ç•™æ›´å¤šçš„ç²¾åº¦

å‰é¢æåˆ°äº†ç²¾åº¦çš„é‡è¦æ€§ï¼Œä»¥åŠæ•´å‹å’Œæµ®ç‚¹å‹å¯è¡¨ç¤ºçš„æœ€å¤§ç²¾åº¦ï¼Œä¸‹é¢æˆ‘ä»¬ä»¥ä¸€ä¸ªå®é™…ä¾‹å­æ¥æ¢è®¨è®¡ç®—è¿‡ç¨‹ä¸­æ˜¯å¦è¦ä¿ç•™æŒ‡å®šçš„ç²¾åº¦ã€‚

```go
var (
	// å¹¿å‘Šå¹³å°æ€»å…±æ”¶å…¥7.11ç¾å…ƒ
	fee float64 = 7.1100
	// ä»¥ä¸‹æ˜¯ä¸åŒæ¸ é“å¸¦æ¥çš„ç‚¹å‡»æ•°
	clkDetails = []int64{220, 127, 172, 1, 17, 1039, 1596, 200, 236, 151, 91, 87, 378, 289, 2, 14, 4, 439, 1, 2373, 90}
	totalClk   int64
)
// è®¡ç®—æ‰€æœ‰æ¸ é“å¸¦æ¥çš„æ€»ç‚¹å‡»æ•°
for _, c := range clkDetails {
	totalClk += c
}
var (
	floatTotal float64
	// ä»¥æµ®ç‚¹æ•°è®¡ç®—æ¯æ¬¡ç‚¹å‡»çš„æ”¶ç›Š
	floatCPC float64 = fee / float64(totalClk)
	intTotal int64
	// ä»¥8ä½ç²¾åº¦çš„æ•´å½¢è®¡ç®—æ¯æ¬¡ç‚¹å‡»çš„æ”¶ç›Š(æ¯æ¬¡ç‚¹å‡»æ”¶ç›Šè½¬ä¸ºæ•´å½¢)
	intCPC        int64 = float2Int(fee / float64(totalClk))
	intFloatTotal float64
	// ä»¥8ä½è¿›åº¦çš„æ•´å½¢è®¡ç®—æ¯æ¬¡ç‚¹å‡»çš„æ”¶ç›Š(æ¯æ¬¡ç‚¹å‡»æ”¶ç›Šä¿ç•™ä¸ºæµ®ç‚¹å‹)
	intFloatCPC  float64 = float64(float2Int(fee)) / float64(totalClk)
	decimalTotal         = decimal.Zero
	// ä»¥decimalè®¡ç®—æ¯æ¬¡ç‚¹å‡»æ”¶ç›Š
	decimalCPC = decimal.NewFromFloat(fee).Div(decimal.NewFromInt(totalClk))
)
// è®¡ç®—å„æ¸ é“ç‚¹å‡»æ”¶ç›Šï¼Œå¹¶ç´¯åŠ 
for _, c := range clkDetails {
	floatTotal += floatCPC * float64(c)
	intTotal += intCPC * c
	intFloatTotal += intFloatCPC * float64(c)
	decimalTotal = decimalTotal.Add(decimalCPC.Mul(decimal.NewFromInt(c)))
}
// ç´¯åŠ ç»“æœå¯¹æ¯”
fmt.Println(floatTotal) // 7.11
fmt.Println(intTotal) // 710992893
fmt.Println(decimal.NewFromFloat(intFloatTotal).IntPart()) // 711000000
fmt.Println(decimalTotal.InexactFloat64()) // 7.1100000000002375
```
å¯¹æ¯”ä¸Šé¢çš„è®¡ç®—ç»“æœï¼Œåªæœ‰ç¬¬äºŒç§ç²¾åº¦æœ€ä½ï¼Œè€Œé€ æˆè¯¥ç²¾åº¦ä¸¢å¤±çš„ä¸»è¦åŸå› æ˜¯`float2Int(fee / float64(totalClk))`å°†ä¸­é—´è®¡ç®—ç»“æœçš„ç²¾åº¦ä¹Ÿåªä¿ç•™äº†`8`ä½ï¼Œå› æ­¤åœ¨ç»“æœä¸Šé¢äº§ç”Ÿäº†è¯¯å·®ã€‚å…¶ä»–è®¡ç®—æ–¹å¼åœ¨ä¸­é—´è®¡ç®—è¿‡ç¨‹ä¸­å°½å¯èƒ½çš„ä¿ç•™äº†ç²¾åº¦å› æ­¤ç»“æœç¬¦åˆé¢„æœŸã€‚

## é™¤æ³•å’Œå‡æ³•çš„ç»“åˆ

æ ¹æ®å‰é¢çš„æè¿°ï¼Œåœ¨è®¡ç®—é™¤æ³•çš„è¿‡ç¨‹ä¸­è¦ä½¿ç”¨æµ®ç‚¹æ•°ä¸”å°½å¯èƒ½ä¿ç•™æ›´å¤šçš„ç²¾åº¦ã€‚è¿™ä¾æ—§ä¸èƒ½è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚

```go
// 1å…ƒé’±åˆ†ç»™3ä¸ªäººï¼Œæ¯ä¸ªäººåˆ†å¤šå°‘ï¼Ÿ
var m float64 = float64(1) / 3
fmt.Println(m, m+m+m)
```

ä¸Šè¿°ä»£ç è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

![](https://note.youdao.com/yws/api/personal/file/WEB4f1cb1ac8d81826e284b9a111085e239?method=download&shareKey=c521e6d17a3a73ff778842e10fcd1736)

ç”±è®¡ç®—ç»“æœçŸ¥ï¼Œæ¯äººåˆ†å¾—`0.3333333333333333`å…ƒï¼Œè€Œå°†æ¯äººåˆ†å¾—çš„é’±å†æ¬¡æ±‡æ€»æ—¶åˆå˜æˆäº†`1`å…ƒï¼Œé‚£ä¹ˆ
è¿™`0.0000000000000001`å…ƒæ˜¯ä»çŸ³å¤´é‡Œé¢è¹¦å‡ºæ¥çš„å˜›ï¼æœ‰äº›æ—¶å€™æˆ‘çœŸçš„æä¸æ‡‚è¿™äº›è®¡ç®—æœºã€‚

è¿™ä¸ªç»“æœå¾ˆæ˜æ˜¾ä¸ç¬¦åˆäººç±»çš„ç›´è§‰ï¼Œä¸ºäº†æ›´åŠ ç¬¦åˆç›´è§‰æˆ‘ä»¬ç»“åˆå‡æ³•æ¥å®Œæˆæœ¬æ¬¡è®¡ç®—ã€‚

```go
// 1å…ƒé’±åˆ†ç»™3ä¸ªäººï¼Œæ¯ä¸ªäººåˆ†å¤šå°‘ï¼Ÿ
var m float64 = float64(1) / 3
fmt.Println(m, m+m+m)
// æœ€åä¸€äººåˆ†å¾—çš„é’±ä½¿ç”¨å‡æ³•
m3 := 1 - m - m
fmt.Println(m3, m+m+m3)
```

ä¸Šè¿°ä»£ç è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

![](https://note.youdao.com/yws/api/personal/file/WEBe8a9929dbaded2c1aa2f8e0e65eacce2?method=download&shareKey=8fbef3b6e5cb8520149b4ad62c3f753c)

é€šè¿‡å‡æ³•æˆ‘ä»¬ç»ˆäºæ‰¾å›äº†é‚£ä¸¢å¤±çš„`0.0000000000000001`å…ƒã€‚å½“ç„¶ä¸Šé¢ä»…æ˜¯è€è®¸ä¸¾çš„ä¸€ä¸ªä¾‹å­ï¼Œåœ¨å®é™…çš„è®¡ç®—è¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦é€šè¿‡`decimal`åº“è¿›è¡Œå‡æ³•ä»¥ä¿è¯é’±ä¸å‡­ç©ºæ¶ˆå¤±ä¹Ÿä¸å‡­ç©ºå¢åŠ ã€‚


ä»¥ä¸Šå‡ä¸ºè€è®¸çš„æµ…è–„ä¹‹è§ï¼Œæœ‰ä»»ä½•ç–‘è™‘å’Œé”™è¯¯è¯·åŠæ—¶æŒ‡å‡ºï¼Œè¡·å¿ƒå¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¯¹å„ä½è¯»è€…æœ‰ä¸€å®šçš„å¸®åŠ©ã€‚

> æ³¨ï¼š
>
> å†™æœ¬æ–‡æ—¶ï¼Œ ç¬”è€…æ‰€ç”¨goç‰ˆæœ¬ä¸º: go1.16.6
>
> æ–‡ç« ä¸­æ‰€ç”¨éƒ¨åˆ†ä¾‹å­ï¼šhttps://github.com/Isites/go-coder/blob/master/money/main.go


ã€å…³æ³¨å…¬ä¼—å·ã€‘

![](https://note.youdao.com/yws/api/personal/file/WEBa3ee67b2b867e98cb5c587f4adfa6801?method=download&shareKey=0fbb95d0aec6170b854e7b890d50d559)